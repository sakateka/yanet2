syntax = "proto3";

package ynpb;

option go_package = "github.com/yanet-platform/yanet2/controlplane/ynpb;ynpb";

import "common/proto/target.proto";

// TODO: docs.
service PipelineService {
	// Lists all configured pipelines
	rpc List(ListPipelinesRequest) returns (ListPipelinesResponse);

	// Returns pipeline definition
	rpc Get(GetPipelineRequest) returns (GetPipelineResponse);

	// Update or insert pipeline
	rpc Update(UpdatePipelineRequest) returns (UpdatePipelineResponse);

	// Allows to delete pipeline with specified name
	rpc Delete(DeletePipelineRequest) returns (DeletePipelineResponse);
}

message ListPipelinesRequest {
	uint32 instance = 1;
}

message ListPipelinesResponse {
	repeated commonpb.PipelineId ids = 1;
}

message GetPipelineRequest {
	uint32 instance = 1;
	commonpb.PipelineId id = 2;
}

message GetPipelineResponse {
	Pipeline pipeline = 1;
}

message UpdatePipelineRequest {
	uint32 instance = 1;
	Pipeline pipeline = 2;
}

message UpdatePipelineResponse {
}

message Pipeline {
	commonpb.PipelineId id = 1;
	repeated commonpb.FunctionId functions = 2;
}

message DeletePipelineRequest {
	uint32 instance = 1;
	commonpb.PipelineId id = 2;
}

message DeletePipelineResponse {
}
