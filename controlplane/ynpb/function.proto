syntax = "proto3";

package ynpb;

option go_package = "github.com/yanet-platform/yanet2/controlplane/ynpb;ynpb";

import "common/proto/target.proto";

// TODO: docs.
service FunctionService {
	// Lists all configured functions
	rpc List(ListFunctionsRequest) returns (ListFunctionsResponse);

	// Returns function definition
	rpc Get(GetFunctionRequest) returns (GetFunctionResponse);

	// Updates or inserts function
	rpc Update(UpdateFunctionRequest) returns (UpdateFunctionResponse);

	// Deletes function with specified name
	rpc Delete(DeleteFunctionRequest) returns (DeleteFunctionResponse);
}

message ListFunctionsRequest {
	uint32 instance = 1;
}

message ListFunctionsResponse {
	repeated commonpb.FunctionId ids = 1;
}

message GetFunctionRequest {
	uint32 instance = 1;
	commonpb.FunctionId id = 2;
}

message GetFunctionResponse {
	Function function = 1;
}

message UpdateFunctionRequest {
	uint32 instance = 1;
	Function function = 2;
}

message UpdateFunctionResponse {
}

message Function {
	commonpb.FunctionId id = 1;
	repeated FunctionChain chains = 2;
};

message FunctionChain {
	Chain chain = 1;
	uint64 weight = 2;
}

message Chain {
	string name = 1;
	repeated commonpb.ModuleId modules = 2;
}

message DeleteFunctionRequest {
	uint32 instance = 1;
	commonpb.FunctionId id = 2;
}

message DeleteFunctionResponse {
}
